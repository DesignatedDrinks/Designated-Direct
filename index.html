<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Designated Direct - Variety Pack Titles</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 20px auto;
        padding: 0 20px;
      }
      .filter-container {
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Choose a Variety Pack</h1>
    
    <!-- Dropdown for the variety packs -->
    <div class="filter-container">
      <label for="varietyFilter">Select Variety Pack: </label>
      <select id="varietyFilter">
        <!-- Options will be dynamically populated -->
      </select>
    </div>
    
    <div id="selectedPack">Loading data...</div>

    <script>
      // Spreadsheet details
      const spreadsheetId = '1TtRNmjsgC64jbkptnCdklBf_HqifwE9SQO2JlGrp4Us';
      const apiKey = 'AIzaSyDx9DhE2lC8WwDp0VLAihrPoiYwMLyPSZE';
      
      // We'll fetch column A, rows 2+ from the "Variety Packs" tab
      const range = "Variety Packs!A2:A";
      const encodedRange = encodeURIComponent(range);

      // Construct the Sheets API URL
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodedRange}?key=${apiKey}`;

      // Fetch the variety pack titles from the Google Sheet
      fetch(url)
        .then(response => response.json())
        .then(data => {
          console.log(data); // For debugging: see the full API response in the console

          const selectedPackDiv = document.getElementById('selectedPack');
          const varietyFilter = document.getElementById('varietyFilter');

          // Check if data is valid
          if (!data.values || data.values.length === 0) {
            selectedPackDiv.textContent = 'No variety packs found!';
            return;
          }

          // Clear the "Loading data..." text
          selectedPackDiv.textContent = 'Please select a variety pack above.';

          // data.values is an array of arrays (e.g., [["Designated Drinks ... 12 Pack"], ["Designated Drinks ... 24 Pack"], ...])
          data.values.forEach(row => {
            const packTitle = row[0]; // The only column in this row
            const option = document.createElement('option');
            option.value = packTitle;
            option.textContent = packTitle;
            varietyFilter.appendChild(option);
          });

          // When the user changes the dropdown, display their selection
          varietyFilter.addEventListener('change', function() {
            selectedPackDiv.textContent = `You selected: ${this.value}`;
          });
        })
        .catch(error => {
          console.error('Error fetching data:', error);
          document.getElementById('selectedPack').textContent = 'Failed to load data.';
        });
    </script>
  </body>
</html>
